##Timing Patterns and Correlations in Spontaneous SCADA Traffic for Anomaly Detection ##

**作者：** Chih-Yuan Lin，Simin Nadjm-Tehrani    
              
**单位：** Linkoping University, Linkoping University, Sweden   
 
**出处：** 22nd International Symposium on Research in Attacks, Intrusions and Defenses, RAID 2019, Chaoyang District, Beijing, China, September 23-25, 2019. USENIX Association 2019  

**原文链接：** <https://www.usenix.org/system/files/raid2019-lin-chih-yuan.pdf>

**笔记作者：**pluto

### 论文简要 ###
监视控制和数据采集(SCADA)系统在现实生活中广泛应用于监视和控制关键基础设施，如废水分配设施、天然气生产系统和发电站等，在社会发展过程中维持着重要作用。但是随着SCADA系统越来越多地采用开放协议并连接到互联网中，使其更易受到一系列的网络攻击，特别是高级持续威胁(APT)。这样的攻击通常是缓慢和隐秘的，但最终会对物理设备造成严重损害。目前针对于这种网络攻击所提出的解决方案大多是基于网络的异常检测方法，该方法主要是利用在请求——响应通信模式中发现的循环流量模式，但基于该模式的检测方法对于IEC-104数据集的检出率很低，因为其没有考虑在非请求模式下的通信流量数据。因此在此基础上作者提出了一种**自发事件时序特征建模的方法**，并利用该模型进行异常检测。

作者提出的这种方法中时序特征主要包含两个时间属性：一个是基于到达间时间，另一个是基于流之间的相关性。作者模型训练所使用的数据集是真实世界的相关公用事业人员通过电力设施收集的网络跟踪流量数据。而测试数据主要来源于两种模拟攻击类型中收集的数据。其中一种攻击由于野战设备的持续故障导致定时异常，另一种攻击由于野战设备上的恶意软件导致间歇性异常，被认为是隐形的。针对于这两种攻击类型的测试，作者提出的方法具有很好的检测精确度，并在实际应用中具有较好的应用前景。

### 系统组件及流程框图 ###
![avatar](https://pic.downk.cc/item/5ea7dd3cc2a9a83be5b720b3.jpg)

### 主要内容 ###
如上述框图所示，作者所提出的系统主要分为3个模块：

- 数据处理模块：本文中作者设置了一个提取器，它可以运行在某一个场所场所，收集异常检测过程的输入跟踪，并且记录包含自发事件的包的时间戳，并将时间戳分离到由三元组{RTU, TID, IOA}定义的流中。然后将每个流中的时间戳序列用作学习训练数据，然后以类似方式收集模拟攻击模型中的数据用作测试数据。

- 模型训练模块：在本文中主要指到达间时间模型的训练和相关性模型的训练。到达间时间模型的训练主要分为3个步骤：平滑、分组和发现边界。前两者主要是对相关参数进行设置，像修改带宽、寻找相对点设置输出的GroupList的大小等。后者主要是针对每个组选择一个最佳边界，用于后续的检测。相关性模型的训练主要分为以下三个步骤：关联配对、相分离和寻找边界。其目标是找出时间序列之间的单调关系，并将它们配对。

- 检测模块：作者使用其模拟的两种攻击类型产生的数据作为测试数据。其中一种攻击由是于野战设备的持续故障而导致定时异常，另一种攻击是由于野战设备上的恶意软件而导致间歇性异常。作者提出的检测模块共分为两层：第一层将输入数据转换为两种数据类型：到达间时间数据和相关性数据，用于后续检测。第二层则计算每个RTU的到达间时间警告数和每分钟的相关警告数，形成多元时间序列进行检测。

最终通过相关模型的训练和测试，作者得出如下实验结果：到达间时间模型提供100%的检出率和0.5%以下的假阳性率；相关模型对主导组实验的检出率为61%~80%。这种结果是一组极为乐观的数据。

### 创新点 ###
- 作者首次针对IEC-104自发流量数据集提出异常检测研究，并结合两种方法，对同一网络中的事件到达时间和流量之间的相关性进行建模，探索出IEC-104自发流量数据集应用于异常检测的潜力。

- 作者整个实验过程是对来自真实电力设施的自发交通的时间属性进行实证研究。 该研究发现，到达时间和流量之间的相关性是稳定的，并且自发交通中存在持续的计时特性。这一研究结果对于未来自发交通异常检测研究具有重大借鉴意义，且本系统所使用的数据集可供进一步的实验使用。

- 作者给出了在自发流量中产生时序异常的两种攻击场景：攻击野外设备和现场设备上的恶意软件，并给出了相应的异常生成方法。这为后续在针对上述两种攻击场景时提供了相应的应对经验。


### 缺点 ###
- 系统整体模型对于回放事件的检测能力较低。

- 当攻击的严重性增加时，到达间时间模型的定时性能会下降，后续可能需要更复杂的模型来监视警报分布的变化，例如使用范围值或移动平均值的模型。并且当事件数量太小(小于8330)时，到达间时间模型在两种方法中都会产生大量(错误)警告。当同一流中的大多数组都太小时，对观测值太少的组的边界进行专门化估计不再有效。

- 对于重播(间歇)异常，在异常持续时间短或原始流量事件率相对较高的情况下，检出率和定时性能不高。

- 在实际应用中对研究设备要求过高。仿真的试验台允许在相同的可重复的场景中比较多个方法，但是在研究社区中仍然缺少为此目的的功能共享研究基础设施。







