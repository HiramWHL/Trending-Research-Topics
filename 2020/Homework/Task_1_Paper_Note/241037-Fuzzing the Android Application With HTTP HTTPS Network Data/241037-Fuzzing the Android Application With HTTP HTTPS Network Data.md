## Fuzzing the Android Application With HTTP/HTTPS Network Data

##### *Author: XINYUE HUANG 1, ANMIN ZHOU1, PENG JIA2, LUPING LIU2, AND LIANG LIU*

#####  *Institution: College of Cybersecurity, Sichuan University, Chengdu 610065, China*

## 一、论文简要

​		论文从传统的基于网络的Fuzzing技术主要是针对服务器端出发，提出了一些针对客户端的网络Fuzzing技术。解决了在基于客户端的Fuzzing技术中，如何实现Fuzzing过程的可重现性，如何提高网络Fuzzing的效率。

## 二、论文内容

​		论文主要分为四个部分，以此介绍了相关的研究、论文实现的基于网络的Fuzzing方法、对该方法有效性的评估、该方法的局限性和未来的工作。

> ### 1、相关研究

​		当下针对 Android 应用的网络数据Fuzzing主要集中在发现服务器端的安全问题。比如Zuo等人通过对手机应用的 HTTP request 使用不同的特征分析来识别协议域，自动替换协议域并且监视服务器端的应答，发现了存在服务器端的认证漏洞。在他们早一些的研究中，提出了一种叫做 AUTOFORGE 的测试框架。该框架主要是通过伪造认证的 HTTP 请求信息并将他们发送到服务器，来测试服务端是否对用户账户进行了足够的校验以保护用户的账户安全。

​		本论文与上述研究相比，注重针对Android应用客户端的Fuzzing。通过对从服务器端受到的应答信息进行变异来检测不同的变异数据对这些应用与服务器交互的影响。

​		与本论文工作相似的是IOTFUZZER，其根据通讯协议，自动生成从IoT应用到IoT设备的消息。该工作与我们的研究是不相同的。

> > 1. 首先，对于IOTFUZZER，其针对的是IoT设备和IoT应用之间的协议。而通讯协议在
> >
> > 不同的IoT设备和IoT应用中是不哟杨的，它需要分析应用来找到可用于测试的域。而我
> >
> > 们的方法，针对的是 HTTP 这种广为人知的通讯协议，我们不需要分析这些应用。
> >
> > 2. HTTP协议较为复杂，很淡定位关键的HOOK对象，但是通过中间代理来获取网络数据报较为简单。

​		现在，基于安卓应用的网络数据分析主要集中在：设备信息识别、应用信息识别、个人信息泄露检测等。

## 2、主要工作内容

​		论文通过使用中间代理截获 Android 应用服务器端对客户端 HTTP 请求的应答报文，并对该报文相关字段进行突变再返回给客户端，以此来找出 Android 应用的漏洞。

​		论文分析了应用程序对 HTTP response 不同状态码的处理过程，发现，只有状态码为302，以及状态码为2XX \ 3XX 的HTTP response会影响安卓应用的相关功能。因此，该论文便将Fuzzing的策略设定为：

```
1. 状态码为302，则对 Location 字段进行突变。
2. 状态码为2XX\3XX，且Content-Length不为0，则根据Content-type字段的类型，使用变异的相应类型的文件数据代替 body 中的原数据。
3. 其他状态码，不对HTTP response 进行处理，直接转发。
```

具体的流程如下：

![img](C:\Users\23717\Desktop\网络空间新技术专题\Fuzzing the Android .jpg)



​		通过这种 Fuzzing 方式， 论文测试了10个安卓应用，发现了4种漏洞，分别为：无应答、应用崩溃、HTML内容替换、非法重定向。



> > **无应答：**文章中无应答有两种情况，一种是测试环境引起，不做赘述。第二种情况是当应用程序的主线程需要其子线程的返回结果，而该子线程也因为某些原因卡住时（文章中是由于返回一个不应为空的空指针），就会引起应用程序该操作无应答。



> > **应用崩溃：**这种漏洞主要是当HTTP response 状态码为2XX\3XX ，且body中为JSON数据的突变引起。因为JSON数据一般可以影响程序的执行流程，所以当应用程序对JSON数据没有进行足够复杂的校验时，错误的JSON数据就可能引起程序崩溃。如果这种崩溃是由于程序本身的代码对JSON数据校验不严格所导致，那么其影响相对来说没有那么大。但是当这种崩溃是由于第三方库对JSON数据校验不严格导致的话，就会造成巨大的影响。



> > **HTML 内容替换：**这种漏洞出现的原因是应用对接收到的HTML格式的内容不进行验证，应用程序接收到什么内容，就显示什么内容。显然，这可能导致用户信息泄露问题。



> > **非法重定向：**这种漏洞的出现的原因与之前所诉的类似，出现的原因就是应用程序对状态码为302的重定向包的Location字段校验不严格所导致。



## 3、创新点



```
	
	论文的创新点就是相比于其他针对Android应用的Fuzzing技术，作者从另一个角度出发，针对客户端的网络数据进行Fuzzing，借此发现 Android 应用本身而非其对应服务器的漏洞。
	
```



## 4、目前缺点

```

1. 不能脱离人工：只能通过人工对应用程序返回的处理结果进行分析来发现漏洞。

2. 需要中间代理：未尝试能否通过伪造回复报文直接向应用发送恶意HTTP response是否会引起相应漏洞。

3. 局限性较大：只能针对HTTP协议，且只针对HTTP协议的部分状态的某些字段。

```



1. 































