# IMP4GT: IMPersonation Attacks in 4G NeTworks

## 1. 论文信息

- 笔记作者：谢斯佳
- 原文作者：David Rupprecht (Ruhr University Bochum), Katharina Kohls (Ruhr University Bochum), Thorsten Holz (Ruhr University Bochum), Christina Poepper (NYU Abu Dhabi)
- 原文题目：IMP4GT: IMPersonation Attacks in 4G NeTworks
- 原文来源：NDSS Symposium 2020 Programme
- 原文链接：https://www.ndss-symposium.org/ndss-paper/imp4gt-impersonation-attacks-in-4g-networks/

## 2. 研究内容

### 简介

​		LTE (4G) 在网络堆栈的第三层上建立了安全认证和密钥协商协议的相互认证，控制平面的永久完整性保护可防止流量受到操纵。但是，缺少用户平面的完整性保护仍然使对手能够操纵和重定向IP数据包。本文提出了一种新的跨层攻击方法，它利用第二层现有的漏洞，并在第三层采用攻击机制对其进行扩展。文中的攻击极大地扩展了可能的攻击场景，从而强调了移动通信标准中用户平面完整性保护的需要。

### 主要内容

​		LTE使用可证明的安全认证和密钥协商协议在网络堆栈的第三层上建立相互认证。最近的一项研究表明，由于可延展的加密，位于电话和网络之间的中间人（MitM）位置的第二层攻击者可以引入无法检测到的位翻转，并将流量重定向到另一个目的地。研究者利用某些 IP 数据包的反射机制，不仅可以重定向用户平面流量，而且还可以创建一个加密和解密预言机，使攻击者能够在用户平面上完全模拟电话或网络，即IMP4GT。IMP4GT完全破坏了第三层上用户平面的相互身份验证属性，因为攻击者可以在任何情况下发送和接收任意IP数据包。

​		IMP4GT可以部署为两个变体：

- 在上行链路模拟变体中，攻击者充当网络的用户；此变体可用于建立与受害人身份相关的到Internet的TCP / IP连接。

- 在下行链路变体中，攻击者冒充网络并可以建立与电话的TCP / IP连接。这样做，攻击者可以绕过提供商的防火墙，并有可能将该连接用于恶意软件的部署或数据泄露。

​		研究人员使用软件定义的无线电进行了攻击，这些无线电可以读取手机和与其连接的基站之间的消息。然后，中间人攻击使黑客可以将用户冒充到网络。准备阶段包括两个初步步骤，A 从 UE 派生内部信息，然后 B 与明文服务器建立连接。 在准备之后，可以执行上行或下行模拟。如下图：

![](https://pic.downk.cc/item/5ea3d5c7c2a9a83be57a22e4.png)

​                                                                           图1 IMP4GT 攻击理论

​		上行链路IMP4GT允许用户完全模仿任意IP服务，例如HTTP服务器。 为此，攻击者必须能够在上行链路方向对数据包进行加密，以建立连接并请求内容。 此外，攻击者必须在下行链路方向解密数据包才能访问从服务器发送的内容。

​		上行IMP4GT攻击包括利用ping反射的上行链路加密和基于不可达反射的下行链路解密，如下图：

![](https://pic.downk.cc/item/5ea3da93c2a9a83be57f5345.png)

​                                                                            图2 上行IMP4GT攻击

​		结合下行加密和上行解密的下行 IMP4GT 攻击。如下图：

![](https://pic.downk.cc/item/5ea3daefc2a9a83be57fb490.png)

​                                                                        图3 下行 IMP4GT 攻击

​		IMP4GT以LTE网络为目标，利用其与连接的移动设备进行通信和验证的方式利用漏洞，利用了缺乏完整性保护以及ICMP反射机制的优势。结果，攻击者可以绕过提供者的任何授权，记帐或防火墙机制。

## 3. 创新点

- 首次将已知的第二层漏洞与第三层攻击结合起来以扩展对手能力。
- 分析了两种类型的反射的默认IP堆栈行为，这使研究者能够为模拟攻击建立加密和解密的Oracle。
- 演示了商用网络中移动电话对IMP4GT的上行链路和下行链路变体的完整端到端实现。
- 逐步的方式描述了IMP4GT的上行和下行变体的分析，影响当前的5G规范，以要求用户平面完整性。
- 由于这是一个可能同时影响4G和5G网络的漏洞，因此也存在在较新形式的网络上进行IMP4GT攻击的可能性。 

## 4. 目前缺点

- 即使攻击者将自己置于受害者和移动网络之间，他们仍然无法自由支配受害者的设备。举例来说，无法进入受害者的Gmail，因为他们仍然需要以正常方式访问该服务。
- 在4G的当前状态下很难进行这种攻击。攻击者需要具有非常强大的专业设备才能做到这一点。
- 攻击者需要与他们想模拟的设备非常接近，以劫持该连接。