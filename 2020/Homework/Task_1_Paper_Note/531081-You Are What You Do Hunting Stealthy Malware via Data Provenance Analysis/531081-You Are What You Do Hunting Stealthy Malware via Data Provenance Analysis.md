论文信息
===
* **标题** You Are What You Do: Hunting Stealthy Malware
via Data Provenance Analysis
* **作者** Qi Wang, Wajih Ul Hassan, Ding Li, Kangkook Jee, Xiao Yu, Kexuan Zou, Junghwan Rhee, Zhengzhang Chen, Wei Cheng, Carl A. Gunter, Haifeng Chen
* **出处和链接** https://www.ndss-symposium.org/wp-content/uploads/2020/02/24167.pdf
* **笔记作者** 唐丝子

论文简要
===
尽管一个隐秘的恶意软件试图混入良性进程中，但它的恶意行为一定会与底层操作系统交互，我们可以用基于源的方式监视操作系统行为。该论文提出了一种基于异常检测的方法，利用os级源图来检测隐藏的恶意软件。PROVDETECTOR通过图形生成、表象提取、嵌入和异常检测四步实现最终结果。

框图
===
![RUNOOB 图标](https://share.weiyun.com/5PQX4fw)

主要内容
===
1. __图形生成__ PROVDETECTOR将进程、文件、套接字作为节点V，节点间的关系作为边E，构建源图G(P)=<V, E>。
2. __表象提取__ 基于稀缺性的路径选择方法，从源图中选择K最不寻常路径作为图的特征。
3. __嵌入__ 路径转换为一整个字符串，然后使用PV-DM模型学习路径的嵌入
4. __异常检测__ 使用局部异常因子（LoF）方法对源图路径嵌入向量进行预测。

创新点
===
1. 这是一个基于os级源图检测恶意软件的系统。
2. 用K最不寻常路径作为图的特征，用以分离恶意部分。
3. 使用局部异常因子作为判断依据。如果一个点比它的邻居具有更低的局部密度，则被认为是一个离群点。

目前缺点
===
1. 实验数据偏小。根据论文说明，良性源数据是某企业306个Windows主机的三个月良性种源数据。隐匿恶意软件的源数据来自viusube下载的大约15000个恶意软件样本。后期建模选择了250个良性过程实例和50个恶意程序，相对于实际情况，这个数据集是非常小的。
2. 论文本身指出，作者通过沙箱运行恶意软件，这种方式对最终结果有影响。
3. PROVDETECTOR仅从良性数据集中学习基于异常检测技术，其本质上是一种白名单建立技术，最终的模型应该也会有误报问题。


