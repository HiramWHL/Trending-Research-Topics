
* 笔记作者: 531120

* 原文作者: Pilar Holgado , Victor A. Villagra, and Luis Vazquez  

* 原文题目: Real-Time Multistep Attack Prediction Based on Hidden Markov Models   

* 原文来源: 网络与信息安全：TDSC IEEE Transactions on Dependableand Secure Computing 2020 17th
[原文链接](https://ieeexplore.ieee.org/document/8031986)  
****
## 论文摘要 ##

  提出了一种基于隐藏马尔科夫模型的新方法，用于使用 IDS 警报预测多步骤攻击。我们认为隐藏状态是特定类型攻击的类似阶段。因此，它可以很容易地适应多步骤攻击，并预见到攻击者的下一步。为实现这一目标，需要根据观测结果进行初步的线外培训阶段。这些观测结果是通过将 IDS 警报信息与以前为此目的构建的数据库进行匹配，使用 CVE 全局数据库中的聚类化方法来避免过度拟合。训练模型使用无监督算法和受监督算法执行。完成训练并计算概率矩阵后，预测模块使用 Viterbi 和向前向后算法，根据正在进行的多步攻击的每个步骤的状态概率计算最佳状态序列。培训模型包括平均警报数和正在进行的警报数，以帮助获得最终攻击概率。该模型被分析为DDoS阶段，因为它是在所有互联网服务中的一个大问题。建议的方法使用当前漏洞验证为虚拟 DDoS 方案。结果证明系统能够执行实时预测。    



## 1、主要内容
    * 利用HMM检测入侵可能性，并做攻击概率检测
    * 基于隐马尔可夫模型生成链路应对不同类型的多步攻击
### 
- 入侵检测基本体系结构
![](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/8858/8960487/8031986/holga1-2751478-large.gif)
- x(t):Markov链状态 
- Y(t):IDS发送的警报
- t：离散时间
- A：描述状态之间的过度矩阵
- Q：观测矩阵
- *：启动概率
  使用以上参数进行训练，对参数的训练分别采用无监督训练和有监督训练，通过比较两种训练方式的差异来选择最佳的训练方式训练马尔科夫模型进行多步预测。
- **马尔科夫链**
![](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/8858/8960487/8031986/holga2-2751478-large.gif)
  不同的多步骤攻击需要一个马尔科夫链来表示每种攻击类型状态。这些链是构建的，选择与每次入侵的类似阶段对应的 HMM 状态数。MM 中的 S 参数由这些状态组成。图显示了三个多步骤攻击（入侵 A、入侵 B 和入侵 N）的示例，分别具有 4、3 和 5 个状态。每个入侵都有不同的 HMM 型号（•A,•B和•C分别）。在下图的右侧，我们将所有 Markov 链表示为从管理员界面显示的攻击图。在此示例中Step|A1和Step|B1,Step|B3和Step|N4和Step|A4和Step|N5是相同的状态
- 构建DDOS攻击模型，并经过训练，利用马尔科夫模型实现攻击场景以及预测评估
![](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/8858/8960487/8031986/holga4-2751478-small.gif)

#### 实验验证以及性能分析：
- 算法验证  
![](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/8858/8960487/8031986/holga5-2751478-small.gif)

- 状态概率结果

- 攻击概率

- 性能测量  
![](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/8858/8960487/8031986/holga10-2751478-small.gif)

#### 实验结果：我们的模型接受系统检测到的任何类型的入侵;也就是说，即使对于未知的入侵，系统也能获得良好的结果，因为它基于自适应模型。入侵预测在许多领域非常有用，包括风险评估和早期响应。并且在性能上有极大的提高，还可以进行取证分析

****
## 2、创新点   
1. 可扩展性：该针对多步攻击预测是针对实时的多步攻击预测，不是局限于固定的多步攻击模式，而是通过马尔科夫链实现多种多步攻击预测
2. 性能优化：使用HMM预测状态概率，同时可以避免过度拟合
3. 可适用范围广：可用于检测或改善误报或者误报活动比率

****
## 3、缺陷  
1. 存在大量的数据处理，在选择最优模式时需要同时进行无监督训练以及有监督训练，才能选择出最优训练方式
2. 针对于马尔科夫链，链上的所有状态皆是独立存在的，多步式攻击有些是一环扣一环的，一个状态的改变会影响下一个状态
3. 存在大量的矩阵运算，需要高超的数学技巧
