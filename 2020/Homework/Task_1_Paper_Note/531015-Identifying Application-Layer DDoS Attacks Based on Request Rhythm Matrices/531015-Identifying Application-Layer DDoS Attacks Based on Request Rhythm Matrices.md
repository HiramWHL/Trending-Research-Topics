# Identifying Application-Layer DDoS Attacks Based on Request Rhythm Matrices

## 论文基本信息

### 标题

Identifying Application-Layer DDoS Attacks Based on Request Rhythm Matrices基于访问节奏矩阵的应用层DDOS攻击识别

### 作者

HUAN LIN, SHOUFENG CAO, JIAYAN WU, ZHENZHONG CAO, AND FENGYU WANG

### 刊物出处与连接

H. Lin, S. Cao, J. Wu, Z. Cao and F. Wang, "Identifying Application-Layer DDoS Attacks Based on Request Rhythm Matrices," in IEEE Access, vol. 7, pp. 164480-164491, 2019.
<https://ieeexplore.ieee.org/document/8888259>

## 论文主要内容总结

### 论文摘要

论文的算法在设计时，由于针对应用层的不同协议产生的DDOS攻击具有各自不同的攻击特性与攻击模式，选择了针对应用层HTTP协议的洪泛攻击作为主要研究对象。  
采用的攻击检测方法使用访问节奏矩阵作为流化模型，定义了异常度作为检测DDOS攻击的重要参数，并在检测到攻击后对攻击主机IP进行识别。对应于流量数据中，提取分组包的相应特征，分组包的大小以及分组包的间隔到达时间等。通过对以上两个特征进行线性变换，将重新定义的数据流中相邻的三个分组包特征进行整合，整合后得到一对特征值。将得到的每对特征值对应到我们初始化的矩阵中，并将该矩阵定义为访问节奏矩阵。每个访问节奏矩阵对应一个数据窗口，记录了该数据窗口内数据流量的表现特征。因此，对每个访问节奏矩阵定义一个异常度。异常度的定义基于正常状态下的访问节奏矩阵，异常度代表了每个访问节奏矩阵与正常访问节奏矩阵之间的差异性。对使用没有发生DDOS攻击的流量构造的访问节奏矩阵进行了异常度的统计计算，并根据统计结果定义了矩阵的异常度的阈值。一旦某个数据窗口生成的访问节奏矩阵的异常度超出阈值，则认为该数据窗口内发生了应用层DDOS攻击。检测到攻击后，该算法还可以对之后的数据窗口内的访问主机的IP进行识别，可以对攻击主机IP进行标记。  
使用了两个流行的DDOS攻击软件HOIC和LOIC来模拟产生数据集，其中LOIC-S与HOIC-P数据集的异常度明显大于HOIC-R数据集的异常度，这与HOIC-R数据集的随机URL攻击模式比较难以识别也是相对应的。从实验结果来看，此方法完全可以对攻击流量进行有效的检测。同时也实验了不同参数对实验结果的影响，FPR基本为０，误报率非常低，算法的TPR即查准率也维持在0.98之上，且使用1998年世界杯官网提供的数据集进行了测试
，在拥塞流量情况下，虽然突发拥塞流量的流量特征与攻击流量十分相似，但是算法完全可以区分出该类流量。

#### 访问节奏矩阵的生成流程

1.按照数据流定义将源IP分类到不同的流  
2.进行归一化处理，对有效的分组记录分组的大小与到达间隔时间  
3.判断是否满足分组包为矩阵窗口大小的整数倍d可以进行数据包整合，不能就等待下一个IP相同的地址分到流中  
4.进行数据包整合，构造访问节奏矩阵，访问节奏矩阵的初始值为0，每进入一个新的落点则将访问节奏矩阵对应位置坐标加1，实现网络数据流到访问节奏矩阵的映射。直至当前数据窗口内的分组包均映射到节奏矩阵上，数据窗口长度以节奏矩阵的落点数为标准，即落点数达到设定数量则数据窗口内分组包映射结束。  
5.判断是否满足数据窗口
6.判断是否还有分组包，还有就继续分到流中，没有就完成构造。所有的访问节奏矩阵可以按照时间顺序形成访问节奏矩阵序列。  

#### 检测算法与IP定位流程

1.构建的访问节奏矩阵序列；  
2.为每个需要检测的访问节奏矩阵定义其基矩阵；  
3.根据当前访问节奏矩阵与其对应的基矩阵，减去横坐标，计算每个坐标的变化率；  
4.按照坐标位置与变化率值，构建当前访问节奏矩阵的变化率矩阵；  
5.得到变化率矩阵后，进行节奏矩阵的异常度的计算；  
6.判断是否发生攻击，如果节奏矩阵的异常度大于设定阈值，则认为发生了DDOS攻击；如果节奏矩阵的异常度小于等于设定阈值，则认为未发生DDOS攻击。  
7.如果发生攻击，则对构建的变化率矩阵进行异常点检测，将检测到的异常点进行标记。如果某个主机IP地址落在异常点的次数超过我们认为的正常的次数，则认为该主机IP地址为攻击主机IP地址。  
关键词：应用层DDOS攻击检测，访问节奏矩阵，异常度，攻击主机IP识别

### 论文主要创新点

1.定义了RM节奏矩阵的新的抽象模型  

2.提出了基于RM节奏矩阵的检测方法  

3.采用四分位检测法准确定位恶意主机的位置与IP  

### 论文缺点

1.该实验数据集只使用了两种主流DDOS攻击工具，在真实的DDOS攻击中黑客似乎更可能会采用自己开发的系列工具或者其他工具实施有效的攻击，无法保证在实际应用中的鲁棒性。  
2.只是针对HTTP协议的DDOS泛洪攻击进行检测算法，对于网络层协议的攻击是无法检测的。
3.识别主机IP的四分位检测法针是计学中常见的一种比较简单高效的异常度检测算法，定义的变化率矩阵上标记出一系列的异常的下落点，然后定义百分比参数0，如果一个IP地址所生成的特征对的坐标所对应的下落点比例超过其下落点总数的0，则认为该主机的IP为攻击主机IP，但此检测方法对数据分布较集中的数据向量有很大的误差。  
4.对于拥塞网络的数据集测试并不是实时的，且距今时间较长，还经过实验者的人为改造引入的变量，不能代表该检测机制能在当代网络拥塞的情况下正常进行实时抓包分析检测。  

### 改进方法

1.采集真实环境数据集或者扩大数据集样本的生成工具种类，提高普适性  
2.针对其他层次的协议进行分析，可以继续采用节奏矩阵的思想处理数据流，实现检测和溯源定位。
3.改进识别主机IP的算法，使其鲁棒性更强。
4.可以进一步部署到真实环境中进行检验。  

### 可以进行的future work

1.识别IP后可以进一步过滤掉攻击流量，减轻服务器资源消耗。  
2.将捕获的攻击数据基于节奏矩阵为特征识别攻击模式或工具，考察是否能作为指纹特征。  
3.将识别的IP进行网络拓扑和相关溯源研究，分离出反射器、跳板机、被攻击机、攻击机。  
4.该算法机制在实际运用中抓包检测的过程尚未可知，进一步考虑在实际中部署的状况。  
