#Detection method of domain names generated by DGAs based on semantic representation and deep neural network

* **笔者：**Bling

* **题目：**Detection method of domain names generated by DGAs based on semantic representation and deep neural network

* **作者：**Congyuan Xu, Jizhong Shen∗, Xin Du

* **出处：**Computers & Security 85(2019) 77-88

* **链接：**https://www.sciencedirect.com/science/article/pii/S0167404818312938?via%3Dihub

#一. 简要
为了识别和分类由多种域名生成算法生成的恶意域名(DGA-DNs)，本文提出了一种新的基于n-gram组合字符和深度卷积神经网络的域名分类模型n-CBDC。该模型借助字符级的语义特征以及CNN和域名信息的平移不变性，将域名视为字符串，通过对域名关键部分的二维张量化和特征的自动提取来判断域名是否由DGAs生成，并且能识别多达十六类DGA-DNs。此外本文还探究了全连接层的节点数目对模型效果的影响，并和15种算法的检测效果进行比较，n-CBDC表现出较好的检出率和鲁棒性。

#二. 主要内容
## 1. n-gram对识别恶意域名的影响  ##
在本实验中，n-gram(n取正整数)是一种表示域名的方法——将预处理后的域名视为字符串，使用长度为n的滑动窗口来依次提取滑动窗口中的元素。将获取的元素按滑动顺序排列，形成n元特征。

<img src="https://pic.downk.cc/item/5ea94bd1c2a9a83be532a2c4.jpg">

令n分别取1、2、3，分别计算恶意域名Conficker、Suppobox、Gozi和正常域名Alexa的Pearson相关系数,相关系数接近0的变量称为无相关性，接近1或-1的变量具有强相关性。从下表可以看出，n的取值对于判断域名是否为恶意域名有影响。

<img src="https://pic.downk.cc/item/5ea94d78c2a9a83be53472fa.jpg">
## 2. n-CBDC模型 ##
**模型结构**

n-CBDC模型由以下六个模块组成，其中域名表示模块为关键部分。

1. 输入模块：接收以字符编码的域名。本实验中输入域名的长度固定为64。
2. 预处理模块：保留域名关键部分，即删除像顶级域名和子域名这样的非决定性因素。
3. 域名表示模块：使用n-gram表示法将域名关键部分转化为二维张量，分别是特征维度和长度维度，以便叠加CNN。在特征维度中，采用独热编码来表示每一个n-gram元素。
4. 特征提取模块：由多个大小不同的卷积核堆叠而成，具有级联和扁平层。在一次卷积操作中，非中心对称的卷积核将输入张量映射到高维度的特征张量中，特征张量再通过最大池化层实现非线性下采样，减少冗余特征。
5. 分类模块：三个包含dropout的全连接层，防止过拟合。
6. 输出模块：采用Sigmoid激活函数，输出域名为DGA-DNs的可能性。

<img src="https://pic.downk.cc/item/5ea94ed3c2a9a83be535e34f.jpg">

**模型训练**

模型训练采用有监督学习方法，数据集中的一万个真实的良性域名来自Alexa顶级网站,15600个真实的恶意域名来自前辈的相关项目，包含16种DGA-DNs。

由下表知，n=3时，模型效果更佳。根据最后一行(overall)的数据知，总体检出率为94.86%，假正率为2.32%，和一次只检测一类恶意域名得到的结果不相上下，因此只需要训练一个n-CBDC模型就能检测16类DGA-DNs。

<img src="https://pic.downk.cc/item/5ea953a7c2a9a83be53aeabc.jpg">

**参数分析**

由于该模型几乎全部参数集中于全连接层，作者分析全连接层节点数量和模型参数数量以及模型性能之间的关系。由下图知，当FC节点数为8时，检出率为92.31%，并且所需参数总量相对较少，性价比较高。

<img src="https://pic.downk.cc/item/5ea953ebc2a9a83be53b36b6.jpg">


##三. 创新点
1. 技术创新：n-CBDC模型借用了自然语言处理中的n-gram模型，提取域名中字符级的语义特征，提高了鲁棒性，克服了现有算法不能检测出特征不明显的DGA-DNs的缺陷。
2. 功能创新：以前的算法都没有彻底分析和比较DGA-DNs的内在差异，因此针对不同类型的DGA-DNs，检测结果波动较大，鲁棒性不强。而n-CBDC模型通过域名的内在语义能判断出16种恶意域名。
3. 算法创新：n-CBDC模型将域名视为原始信号和自然语言文本之间的字符串，表示模块将域名表示为二维张量，便于后续特征提取，因此不需要手工提取特征。
4. 应用创新：n-CBDC模型只以域名作为输入就可以判断出域名是否是DGA-DNs，无需依赖DNS流量、上下文信息或日志，无需获取监视DNS服务器的权限，更无需部署在ISP的数据中心，因此应用场景更广泛。

##四. 目前缺陷
1. n-CBDC模型训练是有监督学习，不能检测超出训练集之外的DGA-DNs。而且作者也提到DGA-DNs相对较难获取，所以也许半监督学习是一个不错的选择。
2. 该模型限制输入的域名长度的最大值为64，对于长度超出64的域名，溢出部分会被截断，几乎无法正常检测，本文并未给出解决方法。
3. CNN是线性模型，对于对抗性样本有极高的脆弱性，微小的对抗性干扰会严重影响模型的判别效果，因此可以尝试进行对抗训练。