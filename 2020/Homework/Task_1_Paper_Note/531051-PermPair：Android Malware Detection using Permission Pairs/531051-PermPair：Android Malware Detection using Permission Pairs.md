*   题目：PermPair: Android Malware Detection using Permission Pairs  
*   作者：Anshul Arora, Sateesh Kumar Peddoju, Mauro Conti  
*   来源：IEEE Transactions on Information Forensics and Security, Volume 15(2020)  
*   链接：<https://ieeexplore.ieee.org/document/8886364>
-----------------------------

## 1、论文概要  
当下智能手机用户越来越多，其中以Android为最，这也导致其易受到恶意软件的攻击。根据数据显示，截至2017年已有350个Android恶意样本记录在案且该数字仍在不断上涨。因此该篇论文针对Android通过权限限制来保证系统安全这一特点，提出了一个Android恶意软件检测模型——PermPair，该模型分别提取恶意软件集和良性软件集中的权限对来构造二者的权限使用图，再将待测软件权限对与上述两图做比较，最终判定其是否为恶意软件。同时，该文中还提出一种边消除算法以减少图中的无关权限对，可以降低空间代价和时间代价。最终结果有95.44%的准确率，在各类检测平台及提出的算法中属中上水平。  

## 2、主要内容  
+   构造PermPair模型如图所示主要有三个阶段：  
![PermPair流程图](https://pic.imgdb.cn/item/5eb01aefc2a9a83be5d722b2.png)  
    1.  图构造阶段   
        针对每个数据集各生成一张图（后文所述全部为无向带权图），对数据集中的app依次提取其申请的权限，每有一个新的权限就在图中添加一个顶点；每有一对权限在同一app中出现则为这两个顶点间添加边，若边已存在则其权重加1。  
    2.  图合并阶段  
        本阶段主要是对使用到的三个恶意数据集生成的图进行合并。顶点（权限）取三图并集即可，但对于边合并来说，由于各图的连边及其权重各不相同，故需要针对多目标进行优化，本文采用加权和方法且具体规定如下：  
        *   当某条边仅在一张图中出现时，直接复制其权重到新图中；  
        *   若某条边在至少两张图中出现，且其权重最大值小于良性图中该边权重/最小值大于良性图中该边权重，则选用最大值/最小值为该边在新图中的权重；  
        *   若某条边在至少两张图中出现，且良性图中该边权重在其范围内，则利用以下公式进行计算：  
            $$ Maximize\quad Z= α_1(m_i-w_n)(w_1+w_2+w_3)+α_2(w_n-m_i)(w_n) $$
            $$ α_1=\frac{\sum_iw_i}{\sum_iw_i+w_n}\quad,\quadα_2=1-α_1 $$  
            ($m_i$为新图待求权重，$w_i$为对应恶意软件图中该边权重，$w_n$为良性图中该边权重)
    3.  检测阶段  
        比较待测软件的所有权限对在恶意软件图和良性软件图中的评分（权重相加），从而进行判定。  

+   Edge Elimination（边消除算法）  
![边消除算法示意图](https://pic.imgdb.cn/item/5eb01b38c2a9a83be5d777d2.png)  
本文提出的边消除算法利用二分法的思想，在保证TPR(Ture Positive Rate)和TNR(True Negative Rate)不降低的前提下，尽量寻找最大无关边集并将其删除，以降低最终成图的复杂度，不仅包括空间复杂度还包括最后检测阶段的时间复杂度。  


##  3、创新点  
+   针对静态权限对分析，分别生成恶意软件权限调用图和良性软件权限调用图，以图论的内容构造评估标准，并辨别恶意app，目前仅在国内一篇19年的论文中找到类似思路，不过该论文构造的是树状图，且分析过程略有不同。  
+   提出一种边消除算法删减无关权限对，在保证准确率的基础上进一步减少了无关计算量。  

##  4、缺点    
+   若恶意软件申请权限较少则检测结果会有很大误差  
+   最后的判定需要比对恶意软件图得分和良性软件图得分，若在恶意app中多申请一些正常应用权限可能逃避检测  
+   部分app开发时为了方便会多申请一些权限，可能会导致模型误判，故仅根据静态提取的权限对无法完全准确判断，还查看实际权限使用情况/API接口等信息  
+   边消除算法为批量删除，无法精确判定某一权限对对最终结果的影响大小，可能误删会提高评估准确率的权限对或留下了降低准确率的权限对        