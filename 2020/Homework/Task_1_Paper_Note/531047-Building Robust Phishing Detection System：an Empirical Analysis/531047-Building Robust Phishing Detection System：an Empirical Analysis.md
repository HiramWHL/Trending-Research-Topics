- 笔记作者：SCU@A2u13
- 原文作者：Jehyun Lee∗ , Pingxiao Ye† , Ruofan Liu∗ , Dinil Mon Divakaran† , Mun Choon Chan∗
- 原文题目：Building Robust Phishing Detection System: an Empirical Analysis
- 原文来源：[Network and Distribute Systems Security(NDSS), Workshop on Measurements, Attacks, and Defenses for the Web, February 23, 2020, San Diego, California](https://www.ndss-symposium.org/wp-content/uploads/2020/02/23007.pdf)



# 论文摘要

为了应对网络钓鱼攻击，本文介绍了如何利用机器学习算法来实现对网络钓鱼攻击的识别与检测。

在通常情况下，许多机器学习检测模型通过使用网络上的正常URL和钓鱼URL的标注数据集来训练二分类的机器学习模型。但是尽管分类器具有较高精确度和召回率，但是同样也容易受到对抗性攻击，其中攻击者试图通过模仿正常网页的特征值来逃避基于ML的分类器。

基于此类检测器的缺陷问题，本文提出了构建健壮的网络钓鱼页面检测系统的方法。

本文使用了基于投票的检测系统采用多种模型，通过在全功能集中随机选择的特征子集中插入噪声来训练每种模型。

本模型使用真实数据集进行了全面的实验，并基于多种规避策略，评估了传统的机器学习模型和本文提出的钓鱼攻击检测系统的鲁棒性。

结果表明，在没有对抗性攻击的情况下，实验人员提出的系统一方面性能接近于原始模型，另一方面，它比原始模型更能抵抗逃避攻击。



# 研究内容

## 机器学习算法性能分析

本文基于多个研究文章中的51个网络钓鱼检测特征来训练不同的分类器。

表中列出了功能类别和示例（为了避免歧义，本文使用带有URL和HTML页面的网络钓鱼页面作为分类实体）

![](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/20200504184451.png)

下图显示了网络钓鱼页面检测机器学习算法的检测性能比较

![](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/20200504184853.png)

可以看到随机森林分类器的效果较其他分类器效果好，因此本文主要讨论和评估基于随机森林分类器。

## 研究钓鱼URL的正常特征混淆

下图展示了逃避攻击下的仿冒页面检测性能（模仿了良性数据集中50％仿冒页面中不同选定特征的值）

![image-20200504185618627](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504185618627.png)

下图展示了仅出于伪造目的而修改了一定比例的网页仿冒页面时的逃避效果

![image-20200504185707717](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504185707717.png)

为了确认由于对网络钓鱼分类器进行规避攻击而造成的威胁，本文在基于随机森林的网络钓鱼页面分类器上进行了一组实验。

在此，实验人员假设模型知识来进行一次简单规避攻击，对于分类器的最重要特征，网络钓鱼页面复制了与良性网页相对应的值。在上图中观察到，选择随机特征进行规避不会显着影响性能，而了解有助于分类的最重要的辨别特征对于对手制定有效的规避页面很重要。

## 威胁模型

攻击者能力：本文假设实验人员的场景中的攻击者具有对机器学习算法的原始理解，可以逃避基于ML的网络钓鱼检测系统。攻击者可以控制域名和提供恶意内容的Web服务器的内容。为了实现这一目标，对手需要具备制定和注册新域名的能力。对手也可能具有学习目标检测系统使用的重要功能的能力。有两种方法可以实现这一目标：

（i）白盒攻击：对手可以使用可公开获取的数据集来构建分类器，例如Alexa顶级网站，PhishTank数据库等；（ii）黑匣子攻击：通过反复测试，攻击者可以潜在地猜测ML模型中使用的功能，因为攻击者还可以观察到攻击的结果（无论是否访问了网络钓鱼网页）

范围和假设：网络钓鱼不限制对手可以利用的功能，只要这些功能来自URL和HTML内容，这两个内容都在攻击者的控制之下。但是，出于实际原因，钓鱼站点不能与正常站点完全相同。例如，以银行网站为目标的网络钓鱼网站至少需要URL有所不同，没有指定将受害者诱骗到网络钓鱼Web服务器的方法。例如，攻击者可以使用垃圾邮件，社交工程，SMS等。

## 构造具有特征排名控制功能的鲁棒性网络钓鱼页面检测

本文提出了一种构建网络钓鱼检测系统的方法，该系统可增强现有网络钓鱼页面分类器针对逃避攻击的鲁棒性。一种简单的方法是训练具有不同特征集的不同分类器；然后使用基于这些分类器的集成模型，以阻止对手学习用于分类的特征。

本文提出了一种不同的方法，其中生成了多个分类器实例，但没有更改功能集和模型构建算法。

通过操纵随机选择的要素的实际值，可以从同一数据集中创建多个分类器。

然后，检测系统可以操作这些分类器的不同实例，这些分类器在逃避攻击方面的总和可能比一个单独的分类器更强

下图展示了网络钓鱼页面建模的流程

![image-20200504191217553](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504191217553.png)

下面展示如何实现

i）使用噪声插入更改模型的特征等级

通过插入噪声来改变特征的重要性和类型排名

![image-20200504191508661](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504191508661.png)

躲避攻击面临两个不同的条件。首先，被攻击特征的特征重要性总和现在要低得多，但是其他一些次要重要性特征在等级越高的情况下就越重要；其次，在自然噪声模型中，不用于规避的特征比原始模型具有更多的特征重要性。在原始攻击中不针对的十一个特征在噪声模型中具有更高的等级。

ii）创建具有不同特征等级的多个模型

![image-20200504191758185](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504191758185.png)

稳健的模型构建必须考虑正常情况下的准确性与逃避攻击下的准确性之间的权衡，所以构建具有不同特征等级的多个模型是十分必要的。

算法本质上是从特征的每个子集（或桶）中选择一个随机数的特征，并将随机噪声插入相应的值，以随后创建具有不同特征等级的多个模型。

iii）使用多个模型构建健壮的网络钓鱼网页检测系统

基于上述算法构建随机生成的模型，然后在操作（或测试）期间执行以下操作：

①对于提供分类的每个输入URL，随机选择一个模型对给定的输入进行分类，然后将该模型的输出作为分类结果。

②同时使用一个投票系统，该投票系统根据每个模型的输出进行决策；多数预测是投票系统预测的类别（网络钓鱼或良性）。本方法的新颖之处在于它基于单个特征向量和给定的固定训练集生成多个随机模型，并将这些生成的模型用于构建鲁棒的多分类器检测系统。

##  数据集

本文实验人员从公共存储库中收集了良性和网络钓鱼URL的列表。实验人员获得了截至2019年2月排名的Alexa顶级网站，并通过爬网从2019年5月10日到8月5日收集了来自300,000个顶级域名的110,090个sam-pling网页。

网络钓鱼URL列表是从PhishTank数据库的每日提要，时间维度为2019年5月30日至7月10日。对于PhishTank每日供稿，实验人员在同一天抓取了可访问的钓鱼页面，因此，总共有32,159个钓鱼页面。实验人员使用数据集的90％作为训练集，其余使用作为测试集。

## 分类模型

（i）本地模型：传统的ML模型（称为``本地模型''）是使用II-A节中提到的具有五十一个URL和HTML功能的随机森林训练的钓鱼页面检测分类器。

（ii）噪声模型：实验人员首先评估在第III-A节中定义的噪声模型；噪声是本机模型的十大重要功能列表。噪声模型与算法2创建的模型相同，其中k = 10，{li} 5i = 1 = [10,0,0,0,0];也就是说，噪声仅插入到本机模型的前十个特征中。（iii）随机生成的模型：实验人员通过运行算法1多次创建了11个模型。根据直觉，将噪声插入存储桶中的更多特征会更改相应特征的排名，而降低高级特征的特征重要性会降低检测准确性，因此实验人员为创建每个模型设置了不同的值。（51个功能中的最后一个一直具有接近于零的重要性；因此实验人员忽略了它。）尝试使用不同的li值，实验人员发现将噪声插入最后两个存储桶并没有进行有意义的更改。实验人员使l3 = 5，然后为前两个存储桶选择值，使得l1的最小值为5，l2的值介于0到10之间，从而l1和l2的总和在15和19之间。因此，实验人员考虑的11种forli组合是：Fivesets [5,5,5,0,0]，[6,4,5,0,0] ... [9,1,5,0,0]，另外五个设置[5,9,5,0,0]，[6,8,5,0,0] ... [9,5,5,0,0]和噪声模型[10,0,0，0,0]

## 规避方法和策略

- 随机特征攻击：如果攻击者无法对网络钓鱼分类器的重要特征做出有根据的猜测，则最简单的策略是使用任意特征来逃避。在这种随机特征攻击中，允许从51个特征的完整列表中随机选择20个特征

- 假设模型生成算法的知识有所逃避：实验人员假设对手具有为模型生成定义的上述算法的知识。但是，对手对运行中的检测系统一无所知。特别地，对手不知道要使用多少个模型，而要使用哪种检测方法（随机选择模型或投票）。因此，对手使用算法2生成一个模型，并将该模型的前20个特征用于生成规避样本。对于在随机生成的模型之一（实验人员考虑的情况）中使用相同模型的检测系统，攻击者保证至少会“命中”正确的模型一次

- 假设算法知识和部分知识的逃避操作：实验人员假设一个更强大的对手，他不仅具有算法2的知识，而且对操作过程中的检测系统有一定的了解。攻击者知道用于构建检测系统的随机生成模型的数量；因此，对手训练了11个模型（如下面的实验中在实验人员的检测系统中使用的模型），随后在模型的前20个特征中找到了20个最经常出现的特征所有模型。然后，将这些最常见的20个功能部件用于生成规避网络钓鱼的样本。这是基于这样的直觉，即如果某个功能在多个模型中频繁出现在高等级中，则它更有可能规避运行模式

## 实验结果：单噪声模型

![image-20200504220756281](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504220756281.png)

通过分析单个噪声模型，其中将噪声插入到前10个特征中。

针对逃避攻击，噪声模型比本地模型更健壮。但是，在没有规避的情况下，噪声模型的AUPRC非常接近于原始模型。但是，为了进行合理的比较，还应该针对噪声模型的前20个特征规避的攻击对噪声模型进行测试。

实验表明，噪声模型较弱攻击，它使用了噪声模型的主要特征。50％逃避测试的AUPRC从高的0.987（不逃避）降低到0.791（逃避）。为了抵抗这种模型，对手必须自己构建一个噪波模型，然后针对主要功能。因此，构建另一个更改特征等级的模型无助于防范逃避攻击。

## 实验结果：具有多个随机模型的检测系统

![](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504221210704.png)

随机生成的模型与原始模型的性能比较

![image-20200504221324396](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504221324396.png)

针对考虑多模型系统（R）的三种规避攻击，多个模型的平均检测性能

![image-20200504221349899](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504221349899.png)

针对三种逃避攻击的投票系统检测性能

![image-20200504221405174](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504221405174.png)

使用广义规避策略攻击时具有静态模型的检测系统的安装性能，该策略使用随机模型中的特征规避

![image-20200504221439061](https://a2u13-pic.oss-cn-chengdu.aliyuncs.com/pic/image-20200504221439061.png)

针对复杂躲避攻击的多模型系统的UPRC

由上可知：

- 经过噪音训练后的模型在面对绕过攻击时比原始模型鲁棒性更强，而面对无绕过攻击的钓鱼网站时两者检测性能差异不大
- 当面对无绕过攻击的钓鱼网站时，原生模型和R、V系统性能差异不大，而当攻击者使用不同的绕过策略后，性能最好的是投票系统V，其鲁棒性最强。

# 创新点

- 通过插入噪声从而提高了攻击者的对抗成本
- 对于不同的模型采用了投票法进行结合，提高了模型的识别准确率
- 通过分析不同的威胁模型从而针对不同的规避策略进行分析，减小了模型的受攻击面
- 采用了特征等级差异化的方式，结合多模型，加大了攻击者猜测模型的难度

# 不足点

- 本文主要针对性能较好的随机森林算法进行了分析，没有对其他的分类算法进行进一步的分析，可能会存在其他分类算法性能和准确率比随机森林算法更高的现象
- 对于现实当中的攻击没有覆盖完全，可能会存在疏漏从而被绕过检测
- 采用了多模型的方式进行检测，在实际使用时可能会存在性能问题

# 总结

本文设计采用了基于随机森林的特征排名控制功能的鲁棒性网络钓鱼页面检测，通过采用投票法和多模型的结合，分析了不同的攻击逃逸方法，设计出了特征等级差异化的多模型网络钓鱼攻击检测模型，同时引入了有效的数据集进行机器学习分析，通过人为加入噪声从而增大攻击者的攻击门槛，对于识别网络钓鱼攻击有一定的作用。

