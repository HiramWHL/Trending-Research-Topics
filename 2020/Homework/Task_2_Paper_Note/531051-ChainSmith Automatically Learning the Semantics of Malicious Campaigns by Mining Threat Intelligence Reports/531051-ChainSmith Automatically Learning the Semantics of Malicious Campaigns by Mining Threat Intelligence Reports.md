### 一、论文信息

**论文标题**：***ChainSmith: Automatically Learning the Semantics of Malicious Campaigns by Mining Threat Intelligence Reports***

**论文作者**：Ziyun Zhu, Tudor Dumitras (University of Maryland, College Park, MD, USA)

**出处**：IEEE European Symposium on Security and Privacy *https://ieeexplore.ieee.org/document/8406617*

**笔记作者**：531051  Harry Potter

### 二、论文简要

**概述**：目前获取现代网络攻击的活动特征的方式主要有大规模的**实地数据**（large-scale field data OR measurement data）和安全从业人员**人工提取并定性的活动特征**（security practitioners extract and report qualitative campaign characteristics manually）。将这两个来源统一起来可以获得更深入的信息，但存在一定的困难性，比如手工提取后的报告以自然语言表述，机器不可读；时耗性。因此本论文的作者提出并实现了ChainSmith系统，能够将测量的数据与人工分析相连接。实验发现该系统有较高召回率与提取准确率。 

**框图**：![](.\框图.png)

### 三、主要内容

#### 1.背景引入

​		威胁情报领域的重点是收集和分析有关安全威胁的信息，以了解对手策略和响应攻击。“威胁情报”已经是一个价值数十亿美元的产业，且已经引入了标准（standard）和信息共享平台（information-sharing platforms）。“标准”用IOC（indicators of compromise）来定义威胁。IOC是可以被观察、提炼出来的攻击构件，比如一个文件的文件名或哈希值、URL、IP地址等。IOC是可以与某给定安全威胁联系起来的。

​		现状是，威胁情报的效用并没有得到很好的理解，比如恶意软件样本经常被重新打包，恶意域名不会长时间处于活动状态。

​		论文作者提出了**一种新颖的威胁情报使用方法**——将情报与实地收集的数据联系起来，来更深入地理解、分析威胁情况，比如识别、总结那些引诱用户运行恶意软件的方法，并通过量化实地恶意软件下载量数据衡量出实际危害性。自动生成这样的“深入理解”要靠IOC的量化，本论文在介绍ChainSmith系统时一直运用的例子是——恶意软件投递活动（malware delivery campaigns）所需的一系列步骤，诱饵（baiting）、利用（exploitation）、安装（installation）和命令控制（command&control）。ChainSmith系统能够从技术文章中自动提取IOCs和它对应的阶段。

![](.\IOC对应阶段.png)

​		为了实现ChainSmith系统，作者实现了专门针对安全领域的新NLP技术；同时，为了准确识别“恶意软件投递活动”这一例子中的阶段，作者提出了包含四个阶段的恶意代码传递模型（malware-delivery model）。

#### 2.陈述目标，并给出载荷传递模型（payload delivery model）的定义

​		在本论文中，给出的ChainSmith系统的应用实例是“理解恶意软件投递活动”。为什么说利用ChainSmith把实地数据与威胁情报联系起来是很有必要的？因为无论是威胁情报还是实地数据都不能提供一个恶意软件投递事件的全貌。威胁情报包含了人工分析出的手法和战略，但是因为没有实际下载量数据而无法系统地评估出这些方法的有效性；实地数据可以系统记载下载量，并拿到各种IOC，但是缺了人工分析的参与而不能清楚其作用。

​		**希望达到的目标**：

- 建立一个通用系统，自动挖掘出自然语言编写的关于安全威胁的描述，并能以相互关联和补充实地数据的格式提取、整理威胁情报；


- 将系统应用到理解恶意软件投递活动的具体问题上，并进行分析，由此延伸出对于威胁情报的充分利用问题。

  **将技术文章自动映射成结构化模式的示例**：

  ![](.\将技术文章映射成结构化模式的示例.png)

  


#### 3.描述ChainSmith的设计

​		ChainSmith的关键核心设计：相邻句子中的上下文词汇能表示出活动的阶段，与IOC直接相关的上下文词汇决定了它的恶意程度。

​		ChainSmith的体系结构：6个部分——文章爬虫（article crawler）；表达式检测器（expression detector）；语法分析器（syntactic parser）；语义分析器（semantic parser）；命名实体识别器（named entity recognition）；IOC分类器（IOC classifier）。

![](.\系统架构.png)

​		其中IOC分类器使用具有1个隐藏层和50个隐藏节点的神经网络来实现。

#### 4.评估ChainSmith的性能；分析不同的诱饵技术（baiting techniques）对二进制传递（binary delivery）的影响

​		现实中待解决的问题——在恶意软件投递领域已有的IOC情报平台数据缺乏；解决方案——通过系统自动分析技术文章，提取IOC；系统性能——14155篇文章，找到24653个IOC。	

​		ChainSmith和基准NLP系统的性能比较，使用的是5倍交叉验证（5-fold cross-validation）：

![](.\性能比较.png)

​		为了诱使用户下载payload，垃圾邮件、被破解/篡改的网站、恶意广告是基本方法，此外还有欺骗性广告等。作者利用ChainSmith研究了不同的手段及它们对后续下载行为的影响；还从证书和抗病毒签名中识别出payload的来源，以此研究出了第一级“供应商”和“客户”间的业务关系。这证明了ChainSmith较完备的功能，同时兼有准确性。

#### 5.相关工作

- 恶意软件攻击

- 威胁情报

- 安全领域的NLP

### 四、论文创新点/优点：

- 从整体idea来说，敏感地察觉到将实地数据与安全人员以自然语言编写的分析报告大批量自动结合在一起的需求，并实现了一个通用系统，自动挖掘出自然语言编写的关于安全威胁的描述，并能以相互关联和补充实地数据的形式提取、整理威胁情报。

- 从自然语言文档中自动提取安全威胁相关的语义的新NLP技术很有意思。已有的一些从技术文章中提取出IOC的技术无法自动重构恶意活动，而ChainSmith可以自动重构整个投递、传播活动的语义。

- 活动信息可以从各个独立的来源收集，对实地数据的要求、限制也比较少。

### 五、论文不足：

- 文章写作方面：摘要提炼得不是很好，没有把论文正文中的研究内容以比较严谨的方式总结出来。论文内容主要是介绍了ChainSmith系统在语义分析和恶意软件识别层面的作用，但在摘要中作者仅介绍了ChainSmith的工作原理，没有点到是为了解决什么问题。

- 论文中的实地数据集来自赛门铁克的WINE平台，并没有覆盖整个互联网，可能有数据不完整、存在某种偏向的问题。

- 没有说明评估IOC在检测恶意活动中的有效性，实地数据和技术文章中共享出来的IOC可能并不太多，如何最大程度地利用威胁情报来实时检测恶意活动还不是很清楚。

- 整个系统的工作结果需要建立在威胁情报内容准确上。如果不正确，会在提取IOC时引入噪音，那么判断实地数据时也会受影响，比如混淆正常情况和攻击威胁。**可能的解决方案**——不基于特定的IOC检测威胁，而是把重点放在聚合来自多篇技术文章和发生在多个主机的下载事件上，这样也许可以减弱个别错误的影响。







