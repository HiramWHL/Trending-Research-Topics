# 浅谈图神经网络技术（Graph Neural Networks）在网络安全的应用

### 一.图神经网络的简介

​        传统的机器学习所用到的数据是欧氏空间（Euclidean Domain）的数据，欧氏空间下的数据最显著的特征就是有着规则的空间结构，比如图片是规则的正方形栅格，语音数据是一维序列，这些数据能够通过一维或二维的矩阵进行表示，无法对这些数据进行卷积操作。同时，存在一个核心的假设：样本之间是相互独立的。

​        但是，在现实生活中许多数据都是不具备规则的空间结构，即是非欧氏空间下的数据，如电子交易、推荐系统等抽象出来的图谱，图谱中每个节点与其他节点的连接不是固定的。图神经网络可以对非欧氏空间的数据进行建模，捕获数据的内部依赖关系。图神经网络是不规则的、无序的。      

​        近年来，人们对深度学习方法在图上的扩展越来越感兴趣。在多方因素的成功推动下，研究人员借鉴了卷积网络、循环网络和深度自动编码器的思想，定义和设计了用于处理图数据的神经网络结构，由此一个新的研究热点——**图神经网络（Graph Neural Networks，GNN）**应运而生。图神经网络是一种连接主义模型,它通过图节点之间的消息传递来捕获图的依赖性。与标准的神经网络不同,图神经网络保持一种状态,它可以以任意深度表示来自其邻域的信息。

CNN能够提取多尺度的局部空间特征，并将其组合起来，构建出具有高度表达能力的表示形式，在几乎所有的机器学习领域都取得了突破，开启了深度学习的新时代。然而，CNN只能对图像（二维网格）和文本（一维序列）这样的规则的欧几里得数据进行操作，而这些数据结构可以看作是图的实例。CNN的关键在于：局部连接、共享权重和多层结构。这些对于解决图域的问题也非常重要。

下图展示了欧几里得域的图像和非欧几里得域图像的区别：

![image-20200520172613965](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200520172613965.png)

------

### 二、图神经网络的分类

​        可以把图神经网络分为五类：

- 图卷积网络（Graph Convolutional Networks）
- 图注意力网络（Graph Attention Networks）
- 图自编码机（Graph Auto-encoder）
- 图生成网络（Graph Generative Networks）
- 图时空网络（Graph Spatial-Temporal Networks）。

![image-20200520173014649](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200520173014649.png)

------

### 三、图神经网络的应用

​        图神经网络的应用类型主要有**节点分类**、**链路预测**和**图生成**三类，这些应用与许多领域相关，从计算机科学和社会科学到计算生物学和生物化学等。传统的机器学习算法和图嵌入算法在解决以上问题时，它们通过将图结构数据映射到更简单的表示来解决问题。然而，在预处理阶段可能丢失图结构本身的拓扑信息,影响最终的预测结果。图神经网络则是直接处理图结构数据，并且在迭代的过程中始终利用了图本身的拓扑信息，因此较之前的方法取得了更好的结果。

​        在网络空间安全方面较多应用到的是图神经网络技术中的**节点分类**，节点分类主要分为两种：**监督节点分类**和**半监督节点分类**。

- 监督节点分类问题是：给定一些图，图中节点具有特征和真实值，从这些图中学习出一个节点分类模型。对于新的图，模型能将图中的节点分类。
- 半监督节点分类问题是：给定一个图，图中的节点具有特征但只有小部分节点具有真实值，从这个图学习出一个节点分类模型，对图中其余的节点进行分类。

​        利用监督结点分类和多层图神经网络的方法，结合无监督学习算法PM-GraphSOM和传统深度神经网络，可以训练一个网络垃圾邮件分类的模型，这类模型也可以用于其他的社交平台的垃圾信息的检测。神经网络在机器学习领域非常流行。以下是该方法的概述：

​        神经网络由多层组成，它包含一个输入层可以输入参数x（程序的输入）。然后输入通过多个隐藏层，在最后一层获得一个输出，称为输出层。有一个包含N个隐藏层的非常简单的神经网络，每层包含一个神经元。每个神经元有两个相关的值：wi和bi，分别表示神经元的权重和偏移。給定神经元的一个输入x，将生成一个输出(wi*x)+bi。因此，一个输入x被神经网络按照以下方式进行传输。第一个隐藏层接受输入x，生成y=w1x+b1，作为第二个神经元的输入。然后，第二个神经元接受输入y，生成一个输出z=w2y+b2，重复这个过程，在最后的第N个神经元可以得到一个唯一的输出。对于一些用户，我们想知道他们是否是垃圾邮件发送人。每个用户有整数的用户ID，取值范围为minX~maxX（包括两个端点,1=<minX=<maxX=<1000000000）。我们把每个用户ID作为神经网络的第一层的输入，如果最终输出为偶数，则该用户不是垃圾邮件发送者，否则，该用户就是垃圾邮件发送者。

###### 以上内容的参考文献：Di Noi L,Hagenbuchner M,Scarselli F,et al.Web spam detection by probility mapping graphsoms and graph neural networks .In:International Conference on Artificial Neural Netwo

​        利用半监督结点分类可以进行相似二进制码检测。基于图神经网络的新颖方法来计算嵌入基于每个二进制函数的控制流程图，即数字矢量，则可以通过测量两个函数的嵌入之间的距离来有效地进行相似性检测。跨平台二进制代码相似性检测的问题旨在检测来自不同平台的两个二进制函数是否相似。它具有许多安全性应用程序，包括窃检测，恶意软件检测，漏洞搜索等。

###### 以上内容的参考文献：[57] Xu X,Liu C,Feng Q,et al.Neural network-based graph embedding for cross-latform binary code similarity detection.In:Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security New York:ACM,2017.363-376



