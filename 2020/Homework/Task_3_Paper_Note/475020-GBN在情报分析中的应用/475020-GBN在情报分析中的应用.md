- 笔记作者：Ille_Rabbit

- 关键词：GCN，威胁情报，情报分析，黑产挖掘

- 参考文献：

  [1] https://www.eecis.udel.edu/~ruizhang/CISC859/S17/Paper/p19.pdf

  [2] https://www.usenix.org/legacy/events/nsdi09/tech/full_papers/zhao/zhao.pdf

  [3] https://arxiv.org/pdf/0803.0476.pdf

  [4] kdd.org/kdd2016/papers/files/rfp0191-wangAemb.pdf


  

## 1、思路简述

威胁情报是防御思路从过去的基于漏洞为中心的方法进化为以威胁为中心的方法的必然结果，然而情报往往不具备规则的数据结构。与此同时，随着针对各种终端设备的攻击手段越来越多、越来越复杂，情报分析、对威胁的预测需要一种更加高效、自动化的模式来处理。基于图卷积神经网络(GCN)在处理不规则数据结构中的优越表现，选择图卷积神经网络的方法进行自动化的威胁情报分析并对未来攻击做出预测。

## 2、概念描述

### 2.1 图卷积神经网络

我们的现实生活中有很多数据并不具备规则的空间结构，称为Non Euclidean data。比如推荐系统、电子交易、计算几何、脑信号、分子结构等抽象出的图谱。这些图谱结构每个节点连接都不尽相同，是不规则的数据结构。在图数据里面，我们要同时考虑到节点的特征信息以及结构信息，如果靠手工规则来提取，必将失去很多隐蔽和复杂的模式，那么有没有一种方法能自动化地同时学到图的特征信息与结构信息呢？那就是图卷积神经网络(GCN)。

### 2.2 威胁情报

2014年Gartner在《安全威胁情报服务市场指南》（Market Guide for Security Threat Intelligence Service）中提出，威胁情报是一种基于证据的知识，包括了情境、机制、指标、影响和操作建议。2015年Jon Friedman和Mark Bouchard在《网络威胁情报权威指南》（Definitive Guide to Cyber Threat Intelligence）对威胁情报采取如下定义：对敌方的情报，及其动机、企图和方法进行收集、分析和传播，帮助各个层面的安全和业务成员保护企业关键资产。威胁情报描述了现存的、或者是即将出现针对资产的威胁或危险，并可以用于通知主体针对相关威胁或危险采取某种响应。威胁情报被视为一种必需品——它通过主动而不是被动的工作来应对当前和未来的攻击。它旨在建立一个威胁情报系统，记录有关最新威胁和漏洞的信息，并迅速实施补救措施，成为主动网络的一部分。


## 3、阶段分析

我用GCN进行威胁情报分析的整体过程大致分为如下三个阶段：建立关联关系、威胁情报发现、威胁预测。

**1、建立关联关系**

下面介绍三种建立关联关系的方法：

（1）使用资源的关联做图的构建：情报中恶意软件等可能存在一些资源会重复的使用，比如设备、IP、手机号码等。

（2）采用行为同步性：黑产的特点是在短时间内有高频的行为，所以在非常短的时间间隔内，如果两个账号的行为非常趋同，那么可以在两个账号之间建立关联。

（3）采用相似度：原理就是黑产团伙、恶意软件等之间在属性和行为上有很高的相似性。构建的方法就是构建相似度，如果属性之间的相似度高于某阈值，则属性之间会形成一条边。

**2、威胁情报发现**

首先，对是否是主流域名后缀、地理位置、A记录与CNAME、首页完整度等属性的特征检测、审查，比如普通域名大多数常用.com、.net.、.cn等主流后缀，而恶意域名往往会喜欢注册小国家域名，如.io、.ru等，Cn域名一般都要求实名备案，恶意域名很少有cn域名。

其次，通过连通子图或者强连通子图，以及Graph Partition的方法对已掌握情报图网络进行分析，定位威胁情报。

**3、威胁预测**

总结威胁情报的属性特征，根据图神经网络发现的威胁情报的聚集性特征和其他属性特征，对情报图中匹配度较高的部分进行分析，提供攻击预测报告，将评估结果可视化。

