#### **图神经网络在网络空间安全中的应用**

2017141531065

##### 基于图神经网络的入侵检测

通过受损账户认证的横向移动是一种常见的对抗性策略，很难用基于特征或规则的入侵检测系统发现。本文提出了一种基于行为的恶意登录检测方法，该方法利用用户的历史登录行为来建立一个假设的“正常”行为模型。此历史登录活动表示为每日登录图的集合，该集合对访问的系统之间的身份验证进行编码。每个系统或图顶点由一组描述它的图中心度度量和它的登录图的局部拓扑来描述。然后将非负矩阵分解的无监督技术应用于这组特征，将每个顶点分配给一个角色，该角色总结了系统如何参与登录，量化每个顶点拟合程度的重建误差。然后计算其作用，并且可以使用该错误的统计来识别与异常登录相关的系统对应的离群点。本文使用一个运行中的企业网络中的真实登录数据对一小部分特权帐户进行了测试。利用代表对手侧移的登录活动模拟图，测试了该方法在正常活动中识别恶意登录的能力。

##### 基于图神经网络的动态网络异常检测

动态变化的图数据在现实应用中广泛存在，有效地对动态网络异常数据进行挖掘，具有重要的科学价值和实践意义。大多数传统的动态网络异常检测算法主要关注于网络结构的异常，而忽视了节点和边的属性以及网络变化的作用。使用基于图神经网络的异常检测算法，将图结构、属性以及动态变化的信息引入模型中，来学习进行异常检测的表示向量。该方法能够同时提取网络本身的异常特性以及网络变化的异常特性，用于表示向量的学习。

##### 基于图神经网络的二进制代码分析

二进制代码分析是信息安全领域中非常重要的研究领域之一，其中一类目标是在不访问源代码的情况下检测相似的二进制函数。同一份源代码在不同编译器，不同平台，不同优化选项的条件下所得到的二进制代码是不相同的，分析目标是把同一份源代码所编译出的不同的二进制代码找到。传统算法使用图匹配算法解决此问题，但图匹配算法的速度较慢，且准确率较低。随着近年来深度学习算法的发展，部分学者尝试在控制流图（CFG）上使用图神经网络算法，取得了不错的效果。

腾讯安全科恩实验室《Order Matters: Semantic-Aware Neural Networks for Binary Code Similarity Detection》提出了名为Gemini的基于图神经网络的算法，它的输入是两个二进制函数的pair，输出是这两个二进制函数的相似度得分。首先，将二进制函数的控制流图作为输入，并使用人工设计的特征提取方法将每个block表示成低维的向量；然后使用Structure2vec算法计算graph embedding；最后使用siamese网络计算相似度得分并使用梯度下降算法降loss训练模型。与传统方法相比，Gemini的速度和准确率都大幅提升。

![](https://keenlab.tencent.com/zh/img/Order_Matters/1.png)

![](https://keenlab.tencent.com/zh/img/Order_Matters/2.png)

虽然上述方法取得了很大的进步，但仍有一些重要的问题值得研究。一方面，如图所示，每一个block被表示成一个低维向量，这个特征提取的过程是人工设计的，在Gemini中block特征只有8维向量，这个压缩的过程会损失很多语义信息。另一方面，在二进制代码中节点的顺序是一个很重要的特征，而之前的模型没有设计特殊的算法提取这一特征。图3是函数“_freading”在不同平台x86-64和ARM上编译出的二进制代码的控制流图。这两个控制流图的节点顺序是非常相似的，例如node1都与node2和node3相连，node2都与node4和node5相连，而这种相似性可以体现在它们的邻接矩阵上。经过观察，我们发现许多控制流图的节点顺序变化是很小的。为了解决以上两个问题，我们设计了一种总体的框架，包含semantic-aware模块、structural-aware模块以及order-aware模块。

![](https://keenlab.tencent.com/zh/img/Order_Matters/3.png)