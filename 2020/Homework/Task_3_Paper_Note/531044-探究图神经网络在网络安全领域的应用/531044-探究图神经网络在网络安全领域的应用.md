# 探究图神经网络在网络安全领域的应用 #

笔者：Bling 2017141531044

# 一、图神经网络 #
随着数据的数量不断增多，数据之间的关系愈发密切，图成为了表示数据的理想结构——图对一组对象及其关系进行建模，对象和关系分别作为图的节点和边，具有很强的表示能力。然而，由于图的数据是不规则的，传统的神经网络无法处理图的输入。科学家们结合CNN通过共享权重和多层结构来增强学习能力以及图嵌入(GE)在保留图结构和内容的前提下将图数据转换到低维空间这两大优点，提出了图神经网络(GNN)。

GNN是一种高效的、易扩展的新型神经网络结构，可以在图领域对数据进行特征提取和表示，不断更新节点状态直到包含邻居节点的信息和网络拓扑结构特点，最终将这些节点通过特定方法进行输出，得到需要的结果。目前，GNN可以应用于自然语言处理、推理与预测（包括疾病预测）、工业推荐、分类问题、生物医疗、计算机视觉等领域。

# 二、图神经网络的应用 #

**1. 用户意向推荐**

电商平台总是会推荐一些用户近期浏览或者搜索过的商品的同类产品，现有的意向推荐仅利用用户和查询的属性和统计信息，没有充分利用丰富的交互信息。Shaohua Fan等人提出了一种用于意向推荐的新型Metapath-guided嵌入方法(MEIRec)。其基本思想是设计一个异构GNN来丰富用户和查询的表示形式。下图为MEIRec的总体框架。

1. 使用包含<user，item，query>三对象及其关系的异构信息网络(HIN)作为输入。 HIN定义为图G=(V，E)，它具有多个节点类型或链路类型。 在HIN中，使用网络模式来描述网络的元结构，表示了对象类型及其相互作用关系。 
2. 使用统一的术语嵌入来生成商品和查询的初始嵌入，因此不用学习所有对象的嵌入，显著减少参数的数量
3. 汇总由元路径得到的邻居的信息，以便于通过异构GNN来学习用户和查询的嵌入，再各自融合基于不同元路径的用户和查询的嵌入。
4. 结合用户和查询的嵌入以及静态功能来预测用户未来搜索特定查询的可能性，最终将商品推送给用户，实现完整的用户意向推荐过程。

<img src="https://pic.downk.cc/item/5ec5d395c2a9a83be510ae1d.jpg">


**2. 恶意账户检测**

在实际生活中，恶意账户表征出设备聚集性和行为（时间）聚集性，即攻击者通常在少数特定的相关联的设备上进行大量注册或登录，并且大量恶意账户的行为常常在短时间内爆发从而达到攻击目的。基于此，Ziqi Liu等人提出一种用于检测恶意账户的异构图神经网络[2]。该模型的基本思想是：单个帐户是正常帐户还是恶意帐户，取决于其他帐户如何通过拓扑中的设备与该帐户进行聚合，以及与该帐户共享同一设备的其他账户在时间序列中有什么行为。关键技术如下：

1. 使用联通子图法，构建异构账户-设备图，账户和设备是图的节点，账户的时间性行为是图的边，从而达到同时考虑恶意账户设备聚集性和行为聚集性的目的。
2. 使用attention机制来自适应地学习不同类型的设备的重要性，而不是将其归纳为同等的重要性，因为不同类型的设备的噪声程度不同，特定类型设备产生的数据可能会丢失。
3. 使用求和运算符捕获每个节点的T步邻域中的聚集模式，对每种类型的节点的聚集模式进行建模。

注：该模型部署在支付宝上，目标是每天成千上万个新注册的用户，通过过滤掉不和其他账户共享设备的账户来减少系统的工作量。

**3. 谣言检测**

传统的基于深度学习的网络谣言检测技术仅仅考虑谣言的深度传播模式，而忽略了广度散步结构。Tian Bian等人提出了双向图卷积网络（Bi-GCN）[4]。其固有的GCN模型使该方法具有处理图形/树结构的能力和学习更有利于谣言检测的高级表示的能力。但是，GCN只能处理谣言散布的整体结构特征，而并未考虑谣言传播的方向。事实证明沿关系链的深入传播和在整个社会社区中的广泛传播是谣言的两个主要特征，因此Bi-GCN利用GCN和自上而下的有向图来了解谣言传播的模式，利用GCN和自下而上的有向图来捕获谣言分散的结构。此外，该方法通过根特征增强来更准确地学习节点与谣言源帖节点之间的关系，从而达到更好的检测效果。

下图是Bi-GCN的流程图。

<img src="https://pic.downk.cc/item/5ec5e2aac2a9a83be52170e8.jpg">


# 三、总结与思考 #
作为一种表达能力较好、模型较为灵活的图分析方法，GNN已成为机器学习领域中强大而实用的工具。能应用于自然语言处理、推理与预测、分类问题、计算机视觉、生物医疗、工控系统、智能推荐、异常检测、关联分析、恶意代码分析等众多领域。但是GNN也存在缺点：当图结构数据的规模过于庞大时，GNN往往不能满足我们的需求，因为GNN的节点邻域的异质特性使得计算不能批量进行。此外，通过对深度学习算法的对抗样本攻击的学习，不难联想到存在针对图神经网络的对抗攻击——对图的结构或节点特征进行轻微扰动，使得网络对特定节点的预测发生巨大变化。因此，我认为如何防御图对抗攻击会是一个值得进一步探究的问题。


**参考文献**

[1] Shaohua Fan, Junxiong Zhu, Xiaotian Han, Chuan Shi∗, Linmei Hu, Biyu
Ma, and Yongliang Li. 2019. Metapath-guided Heterogeneous Graph Neural Network for Intent Recommendation. In The 25th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (KDD ’19), August 4–
8, 2019, Anchorage, AK, USA. ACM, New York, NY, USA, 9 pages. https:
//doi.org/10.1145/3292500.3330673

[2] Liu, Z., Chen, C., Yang, X., Zhou, J., Li, X., & Song, L. (2018). Heterogeneous Graph Neural Networks for Malicious Account Detection. Proceedings of the 27th ACM International Conference on Information and Knowledge Management - CIKM ’18. doi:10.1145/3269206.3272010 

[3] Tian Bian and Xi Xiao and Tingyang Xu and Peilin Zhao and Wenbing Huang and Yu Rong and Junzhou Huang.2020.Rumor Detection on Social Media with Bi-Directional Graph Convolutional Networks.arXiv:2001.06362v1 [cs.SI] 17 Jan 2020

[4] 王佳.图神经网络浅析[J].现代计算机,DOI:10.3969 j.issn.1007-1423.2019.23.013.
